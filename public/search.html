<!DOCTYPE html>
<html>
    <head>
        <title>Search Recipes</title>
        <link rel="stylesheet" href="style.css">
    </head>

    <body>
        <div class="navbar">
            <a href="index.html"><div class="navbar_item">Home</div></a>
            <a href="list.html"><div class="navbar_item">My Recipes</div></a>
            <a href="search.html"><div class="navbar_item">Search</div></a>
            <a href="pantry.html"><div class="navbar_item">Pantry</div></a>
            <a href="settings.html"><div class="navbar_item">Settings</div></a>
        </div>

        <div class="app_main">
            <img class="logo" src="media/recipebuddy.png">

            <div class="search_container">
                <div class="search_content">
                    <h3>Search Recipes</h3>
                    <input class="text_field" id="SEARCH_TEXT"></input>
                    <p>

                    <h3>Time</h3>

                    <p>
                        <input type="radio" name="TIME_INPUT" value="NOPREF" checked>
                        <label>No Preference</label>
                    </p>
                    <p>
                        <input type="radio" name="TIME_INPUT" value="BREAKFAST">
                        <label>Breakfast</label>

                    </p>
                    <p>
                        <input type="radio" name="TIME_INPUT" value="LUNCH">
                        <label>Lunch</label>
                    </p>
                    <p>
                        <input type="radio" name="TIME_INPUT" value="DINNER">
                        <label>Dinner</label>
                    </p>

                    <h3>Ingredients</h3>

                    <p>
                        <input type="radio" name="INGREDIENTS_INPUT" value="ALL">
                        <label>Show only recipes I have everything for</label>
                    </p>

                    <p>
                        <input type="radio" name="INGREDIENTS_INPUT" value="SOME" checked>
                        <label>Show more recipes (1 or 2 things missing)</label>
                    </p>

                    <p>
                        <input type="radio" name="INGREDIENTS_INPUT" value="NONE">
                        <label>Don't filter by ingredients</label>
                    </p>

                    <h3>Allergens</h3>

                    <p>
                        <input type="radio" name="ALLERGENS_INPUT" value="BLOCK" checked>
                        <label>Don't show recipes with my allergens</label>
                    </p>

                    <p>
                        <input type="radio" name="ALLERGENS_INPUT" value="SHOW">
                        <label>Show recipes with my allergens</label>
                    </p>

                    <button class="inline_button">Search</button>
                </div>
            </div>

            <div class="spacer"></div>
            <div class="spacer"></div>

            <div class="search_container">
                <div class="search_content">
                    <h2>Search Results</h2>
                </div>
            </div>

            <div id="SEARCH_RESULTS"></div>
        </div>

        <script>
            const RECIPELIST_URL = "api/recipes"
            
            function display_recipe_list() {
                fetch(RECIPELIST_URL, {
                    method: "GET",
                    headers: {
                        "Accept": "application/json",
                    },
                }).then(async response => {
                    const data = await response.json();
                    console.log(data);
                    formatted_result = "";
                    for(let i in data.recipes) {
                        let recipe = data.recipes[i];
                        console.log(recipe);
                        var recipeHTML = `
                        <div class="recipepreview_container">
                            <div class="recipepreview_photoframe">
                                <img class="recipepreview_photo" src="${recipe.photo}">
                            </div>
                            <div class="recipepreview_content">
                                <h2>${recipe.name}</h2>
                                <p>${recipe.rating}&#9733; - Cooked ${recipe.cooked} times.</p>
                                <a href="viewer?id=${recipe.id}"><div class="inline_button">Make It</div></a>
                                <a href="editor?id=${recipe.id}"><div class="inline_button">Edit</div></a>
                            </div>
                        </div>
                        `
                        formatted_result += recipeHTML;
                    }

                    document.getElementById("SEARCH_RESULTS").innerHTML = formatted_result;
                });
                /*.catch(error => {
                    document.getElementById("RECIPE_LIST").innerHTML = "Error!";
                });*/
            }
        
            display_recipe_list();
        </script>
    </body>
</html>